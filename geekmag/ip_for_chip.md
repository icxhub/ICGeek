# 终于懂得IP 对于芯片如此珍贵，那么...

<!-- 原创认证 -->
<img src="https://yb-img.oss-cn-shanghai.aliyuncs.com/badges/4B34TDULMV6O4WA0ON1XBMI68T1K8PS3OPND6WJU5FWE0NF4S1.png" style="float:right;">

本文经「原本」原创认证，访问[yuanben.io](http://yuanben.io/)查询[【4B34TDUL】](https://yuanben.io/article/4B34TDULMV6O4WA0ON1XBMI68T1K8PS3OPND6WJU5FWE0NF4S1)获取授权信息。

---

![IC 极客](../res/img/apple_equ.jpg)

## 导读

在美国“封杀”中兴通讯事件影响下，国之重器芯片行业受到前所未有的关注，随后阿里巴巴全资收购自主嵌入式CPU IP Core 公司——中天微的消息也一度刷屏。极客群的群友们就此纷纷展开热议，国产IP 的出路在哪里？国产EDA 的出路在哪里？我们能做些什么？是的，“芯”痛不如行动，在IP 和EDA 的交叉领域，沿着大家在群里讨论的思路我希望继续展开谈一下，IP 管理有多重要。

我曾经在不同公司主导或参与过IP 质量检查和IP 管理的流程开发，基于自己的一些经验体会和所思所感，我从以下四个角度来谈一下对这个问题的理解，作为一个开放性的话题，希望可以给读者带来一些启发和探讨。

* IP 为什么重要
* 客户的安全感从哪里来
* IP 管理需要考虑哪些因素
* 延伸思考

## IP 为什么重要

很多SOC 厂商都依赖IP 来设计和生产一款SOC 芯片，做SOC 的过程其本质就是寻找，验证及整合IP 的过程。如果能够找到满足需求的，质量可靠的，验证过的IP 会极大缩短SOC 的开发周期，这个模式在过去几十年已经非常成熟。

IP 非常重要，对IP 的选择除了质量因素，价格也是重要的考量。随着用户数越多，这个价格会被分摊掉，相对容易承受。

随着芯片复杂度的提高，定制化需求越来越多，IP 产品也有自己的开发和生命周期。是否能够在上市时间和定制化方面更好的满足客户需求，也成为IP 供应商和用户越来越关心的事情。

SOC 对IP 的应用模式随着市场需求，芯片复杂度，上市时间和成本的压力一直在发生变化，当然这也间接导致了行业内IP 的生态发生相应的变化。从SOC 视角看，对IP 的使用可以简单的分为三种情况

* 只为这一个芯片定制的IP，通常发生在企业内部
* IP的选择来自于IP 平台，成熟的hardening IP。有些企业内部有自己的IP 平台，同时也会选择第三方IP 平台的产品。这类IP 的开发就是为了被大量的用户重复使用以降低成本
* IP的选择来自于IP 平台，但在SOC SPEC 阶段就一起规划IP 开发，为满足用户的schedule，其研发周期几乎与SOC 同步

不同的IP 策略选择对于验证和芯片回来后的测试也会有不同的影响。

## 客户的安全感从哪里来

综上所述，SOC 芯片设计的各个环节都重度依赖于IP 的选择，IP 供应商和客户之间的关系也因此而越来越紧密。但是并非所有的IP 都有良好的质量保证，做过充分的验证，有符合主流EDA 流程需要的完整的数据和清晰的文档。SOC 芯片流片失败有超过40% 的原因都会和IP 有关，譬如非常常见的设计本身错误，产品和需求不匹配，版本用错，有些design for reuse 的IP，会打包发布，这时候容易出现工艺用错，金属层用错。还有datasheet 和IP view 不一致，IP 自身质量不合格或者严格一点说是和SOC 自身的验证流程不匹配等等。SOC 设计师拿到IP 之后还需要再次做质量检查和验证，而SOC 集成时候检查出来的问题或者更严重的IP 本身错误原因导致的流片失败等问题都导致IP 客户的不安全感，以及SOC 厂商和IP 供应商在不得不在彼此依赖的密切合作中形成一种越来越紧张的关系。通常，对于IP 的选择会有如下几个方面的考量

1. IP 选择

通常需要考虑的因素有如下几个方面，成本，成熟度，之前项目的经验等等，PPA 和datasheet 与当前项目需求是否吻合。如果是第一个项目试用，那么IP 的开发和SOC 的开发节奏是否能够契合也是一个很重要的考量。

对于设计服务公司而言，每次在IP 选择的这个环节都要大费周章。即便是产品公司，IP 的选择也并非一成不变，毕竟市场随时都在变化。

2. IP 的 view

在做选择的同时也不能忽略IP view 的完整性和你的SOC 设计流程是否匹配。主要看是否满足我们的设计流程以及工具的需求，这其中包括前端，后端，dft 等等。当然这是SOC 和IP vendor 双方妥协磨合的过程，通常问题不大，但出问题的地方也不是一件小事。所以，这也是做设计之前需要考量的一个方面。

3. IP 质量检查

对于一些不太知名的，或者第一次合作的IP 厂商（包括企业内部自建IP），在把它应用于SOC 设计之前，必要的QA 环节是非常重要的，同样重要的就是QA 流程的自动化。

4. IP 的版本跟踪

版本跟踪的重要性不言而喻。项目的重要里程碑特别是Tapeout 检查，我们需要和IP vendor 反复确认版本是否正确。

## IP 管理需要管什么

前面我们讨论了IP 为什么重要以及客户在选择和使用IP 时需要考量的因素。  对于IP，需要管理的事情之琐碎，信息量之庞大已经远远超过了人工所能负荷的范畴，我们需要结合实际的应用场景寻找一种更加简单，优雅，更低成本的做法。 

首先，需要先看IP 管理的使用者是谁，可能是SOC 厂商或者IP 供应商，也可能是SOC 设计师或IP 设计师，或者将他们基于需求连接，在这简单的几句话里隐藏了大量的应用场景，他们分别需要怎样的信息和数据以及如何使用这些信息和数据。从来源看无论是为一个芯片定制的IP，还是IP 平台，IP 的来源都分为企业内部和第三方。从IP 生命周期的视角看，企业对内部IP的管理，分研发管理和应用管理，对第三方IP 的管理主要需要满足信息化和与SOC 开发协同。从IP 开发流程的视角看，IP 分digital, analog, mix-signal。这都是做IP 管理可以考虑的切入点。

第二，IP 的质量检查和一致性。质量检查最通用的做法对于SOC 工程师而言就是基于你已有的流程搭建测试平台，重跑一遍 DRC, LVS, ERC, and antenna ，并且利用现有的EDA 工具的命令或API 针对Verilog, LIB, LEF, and GDS 等你关心的view 做pin to pin 完整性和一致性分析。如果要做的比较细的话，可以深挖出更多的需求。对于IP 交付而言，除内建质量检查外，同时还需要考虑满足不同客户，不同EDA 工具和企业流程他们所需的数据格式不同，这些数据之间的完整性和一致性问题。此外，还有一些客户需要在系统设计和验证以及post-silicon 之后有一些额外的需求，也是IP 交付管理中需要考量的内容

第三，SOC 与IP 协同开发平台，需求管理，文件管理，信息同步管理。如何满足点到点的对接，如何利用这些链接产生新的价值，从而提高整体研发平台的设计效率和自动化。如何在整个过程中积累和分享整体运作的知识和方法

## 思考几个问题

* 如果你是SOC 厂商，在选择IP 的策略上有哪些考虑
* 如果你是IP 供应商，如何管理你的产品和连接你的用户，以及他们在不同时间段的不同需求
* 如果你是SOC 设计师，在使用IP 之前会去重复检查质量和做验证吗，分别使用什么方法和策略
* 如果你是IP 设计师，如何做交付质量管理和持续交付

## 给自家IC 极客群打个广告

本群由IC 行业的几位工程师发起，以公益，开源，分享为宗旨，致力于推广IC 极客文化，组织大家深入交流IC 设计领域知识，经验及方法学，打造IC 设计圈的思想国。群内交流的方式为，每周二，五定期推送固定主题的干货文章，发起相关主题的群内头脑风暴和技术分享。也欢迎群友或IC 极客玩家随机发起不固定主题的讨论。欢迎联系文末的微信号小主入群参与分享交流。
在未来一周内，我会在IC 极客群内陆续分享一些之前做过的IP 质量检查和IP 管理流程开发经验，同时预告下周五的主题“IC 设计中的数据管理，版本管理及配置管理”，如果你身边有对此类话题感兴趣的朋友，不妨邀请他入群一起参与讨论或围观。
另外，你们心心念念的DFT 专场也会在近期开场，如果您希望参与开讲或讨论老样子联系文末的微信号小主。

![入群](../res/img/wechat_sgsphoto.jpg)